<!-- Path: GeneralWebApi/Frontend/general-frontend/src/app/shared/components/header/header.component.html -->
<header class="app-header">
  <div class="header-brand">
    <div class="brand-logo">
      <span class="logo-text">GW</span>
    </div>
    <div class="brand-title">{{ brandTitle }}</div>
  </div>
  <div class="header-actions">
    <!-- Quick Actions -->
    <div class="quick-actions">
      <div class="notification-wrapper" [class.open]="isNotificationDropdownOpen">
        <button
          class="action-button notification-btn"
          (click)="onNotificationClick($event)"
          [attr.aria-label]="'Notifications (' + notificationCount + ')'"
          [attr.aria-expanded]="isNotificationDropdownOpen"
        >
          <span class="action-icon material-icons">notifications</span>
          <span 
            class="notification-badge" 
            *ngIf="notificationCount > 0"
            [attr.data-count]="notificationCount > 99 ? '99+' : notificationCount"
          >
            {{ notificationCount > 99 ? '99+' : notificationCount }}
          </span>
        </button>

        <!-- Notification Dropdown -->
        <div class="notification-dropdown" *ngIf="isNotificationDropdownOpen">
          <div class="dropdown-header">
            <h3>Notifications</h3>
            <span class="unread-count" *ngIf="notificationCount > 0">
              {{ notificationCount }} unread
            </span>
          </div>

          <div class="dropdown-content">
            @if (isLoadingNotifications) {
              <div class="loading-state">
                <span class="material-icons">hourglass_empty</span>
                <span>Loading...</span>
              </div>
            } @else if (recentNotifications.length === 0) {
              <div class="empty-state">
                <span class="material-icons">notifications_none</span>
                <span>No notifications</span>
              </div>
            } @else {
              <div class="notification-list">
                @for (notification of recentNotifications; track notification.id) {
                  <div 
                    class="notification-item"
                    [class.unread]="notification.status === 'unread'"
                    (click)="onNotificationItemClick(notification)"
                  >
                    <div class="notification-icon-wrapper">
                      <span class="material-icons">{{ getNotificationIcon(notification.type) }}</span>
                      @if (notification.status === 'unread') {
                        <span class="unread-dot"></span>
                      }
                    </div>
                    <div class="notification-content">
                      <div class="notification-title">{{ notification.title }}</div>
                      <div class="notification-message">{{ notification.message }}</div>
                      <div class="notification-time">{{ getTimeAgo(notification.createdAt) }}</div>
                    </div>
                  </div>
                }
              </div>
            }
          </div>

          <div class="dropdown-footer">
            <button class="view-all-btn" (click)="onViewAllNotifications()">
              <span>View All Notifications</span>
              <span class="material-icons">arrow_forward</span>
            </button>
          </div>
        </div>
      </div>

      <button
        class="action-button settings-btn"
        (click)="onSettingsClick()"
        aria-label="Settings"
      >
        <span class="action-icon material-icons">settings</span>
      </button>

      <button class="action-button theme-toggle" (click)="onThemeToggle()">
        <span class="action-icon material-icons">{{
          isDarkMode ? 'light_mode' : 'dark_mode'
        }}</span>
      </button>
    </div>

    <!-- User Profile -->
    <button
      class="user-profile"
      (click)="onProfileClick()"
      (keyup.enter)="onProfileClick()"
      (keyup.space)="onProfileClick()"
      aria-label="User profile menu"
    >
      <div class="user-avatar">
        <span class="material-icons">person</span>
      </div>
      <div class="user-info">
        <div class="user-name">{{ userProfile.name }}</div>
        <div class="user-role">{{ userProfile.role }}</div>
      </div>
    </button>

    <!-- Mobile Menu Toggle -->
    <button
      *ngIf="showSidebarToggle"
      class="action-button mobile-menu-toggle"
      (click)="onSidebarToggle()"
    >
      <span class="action-icon material-icons">menu</span>
    </button>

    <!-- Login Button -->
    <a *ngIf="showLoginButton" routerLink="/login" class="btn btn-primary">
      Login
    </a>
  </div>
</header>
