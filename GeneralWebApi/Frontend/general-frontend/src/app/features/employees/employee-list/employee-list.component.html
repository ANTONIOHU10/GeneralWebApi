<!-- src/app/features/employees/employee-list/employee-list.component.html -->
<app-base-private-page-container
  [title]="'employees.title' | translate"
  [subtitle]="'employees.subtitle' | translate"
  icon="people"
  [showTabs]="true"
  [showSearch]="activeTab() === 'list'"
  [tabs]="tabs"
  [activeTabId]="activeTab()"
  (tabChange)="onTabChange($event)"
>
  <!-- Search and View Toggle in header - only shown when list tab is active -->
  <div *ngIf="activeTab() === 'list'" slot="search" class="header-actions">
    <app-base-search
      [config]="{
        placeholder: ('employees.searchPlaceholder' | translate),
        debounceTime: 300,
        minLength: 1,
        showClearButton: true,
        showSearchButton: true,
      }"
      (searchChange)="onSearchChange($event)"
      inputId="employee-search"
      class="search-input"
    ></app-base-search>
    
    <!-- View Toggle Button -->
    <app-base-button
      [icon]="getViewModeIcon()"
      [text]="getViewModeLabel()"
      variant="outline"
      size="small"
      (buttonClick)="toggleViewMode()"
      [title]="(viewMode() === 'table' ? ('view.switchToCard' | translate) : ('view.switchToTable' | translate))"
      customClass="view-toggle-btn"
    ></app-base-button>
  </div>

  <!-- Employee List Tab Content -->
  <div *ngIf="activeTab() === 'list'">
    <app-base-async-state
      [loading$]="loading$"
      [error$]="error$"
      [data$]="employees$"
      [loadingMessage]="'employees.loading' | translate"
      [emptyTitle]="'employees.emptyTitle' | translate"
      [emptyDescription]="'employees.emptyDescription' | translate"
      [emptyActionText]="'employees.emptyActionText' | translate"
      [onRetry]="onRetryLoad"
      [onEmptyAction]="onEmptyActionClick"
    >
      <!-- Success content: Table View -->
      <app-base-table
        *ngIf="viewMode() === 'table'"
        [data]="(employeesArray$ | async) || []"
        [columns]="tableColumns"
        [actions]="tableActions"
        [config]="tableConfig"
        [pageSize]="(pageSize$ | async) || 20"
        [currentPage]="(currentPage$ | async) || 1"
        [totalPages]="(totalPages$ | async) || 1"
        (rowClick)="onTableRowClick($event)"
        (sortChange)="onTableSortChange($event)"
        (pageChange)="onTablePageChange($event)"
        (pageSizeChange)="onTablePageSizeChange($event)"
        class="employee-table"
      >
        <!-- Avatar Template -->
        <ng-template #avatarTemplate let-employee="$implicit">
          <app-base-avatar
            [src]="employee.avatar || ''"
            [fallbackText]="getInitials(employee)"
            [alt]="getFullName(employee)"
            size="small"
            shape="circle"
          ></app-base-avatar>
        </ng-template>

        <!-- Status Template -->
        <ng-template #statusTemplate let-employee="$implicit">
          <app-base-badge
            [text]="employee.status | titlecase"
            [variant]="getStatusVariant(employee.status)"
            size="small"
          ></app-base-badge>
        </ng-template>
      </app-base-table>

      <!-- Success content: Card View -->
      <div *ngIf="viewMode() === 'card'" class="employee-grid">
        <app-employee-card
          *ngFor="let employee of employees$ | async"
          [employee]="employee"
          [showActions]="true"
          (edit)="onEditEmployee($event)"
          (delete)="onDeleteEmployee($event)"
          (view)="onViewEmployee($event)"
        >
        </app-employee-card>
      </div>
    </app-base-async-state>
  </div>

  <!-- Add Employee Tab Content -->
  <div *ngIf="activeTab() === 'add'">
    <app-add-employee (employeeCreated)="onEmployeeCreated()"></app-add-employee>
  </div>

  <!-- Search Employee Tab Content -->
  <div *ngIf="activeTab() === 'byDepartment'">
    <app-search-employee></app-search-employee>
  </div>

  <!-- Reports Tab Content -->
  <div *ngIf="activeTab() === 'reports'">
    <app-employee-reports></app-employee-reports>
  </div>

  <!-- Settings Tab Content -->
  <div *ngIf="activeTab() === 'settings'">
    <app-employee-settings></app-employee-settings>
  </div>
</app-base-private-page-container>

<!-- Employee Detail Modal -->
<app-employee-detail
  [employee]="selectedEmployeeForDetail"
  [isOpen]="isDetailModalOpen"
  [mode]="detailMode"
  (closeEvent)="onCloseDetailModal()"
  (employeeUpdated)="onEmployeeUpdated($event)"
></app-employee-detail>

<!-- Employee Hierarchy Modal -->
@if (showHierarchyModal() && selectedEmployeeForHierarchy()) {
  <app-base-modal
    [isOpen]="showHierarchyModal()"
    [title]="'employees.hierarchy.title' | translate"
    [config]="{
      size: 'large',
      closable: true,
      backdrop: true,
      keyboard: true,
      animation: true,
      centered: true,
      scrollable: true
    }"
    (closeEvent)="onCloseHierarchyModal()"
  >
    <app-employee-hierarchy
      [employeeId]="selectedEmployeeForHierarchy()!.id"
      [employeeName]="getFullName(selectedEmployeeForHierarchy()!)"
    ></app-employee-hierarchy>
  </app-base-modal>
}
