<!-- Path: GeneralWebApi/Frontend/general-frontend/src/app/features/contract-reminders/contract-reminder-list/contract-reminder-list.component.html -->
<app-base-private-page-container
  [title]="'contractReminders.title' | translate"
  [subtitle]="'contractReminders.subtitle' | translate"
  icon="notifications"
  [showTabs]="false"
  [showSearch]="false"
>
  <!-- Filter -->
  <app-base-card [title]="'common.filter' | translate" [icon]="'filter_list'" [variant]="'elevated'">
    <div class="filter-container">
      <label>{{ 'contractReminders.filterLabel' | translate }}</label>
      <select [value]="filterDays()" (change)="onFilterChange(+$any($event.target).value)">
        <option [value]="7">{{ 'contractReminders.filterOptions.7days' | translate }}</option>
        <option [value]="30">{{ 'contractReminders.filterOptions.30days' | translate }}</option>
        <option [value]="60">{{ 'contractReminders.filterOptions.60days' | translate }}</option>
        <option [value]="90">{{ 'contractReminders.filterOptions.90days' | translate }}</option>
      </select>
    </div>
  </app-base-card>

  <!-- Statistics -->
  <div class="statistics-grid" *ngIf="reminders().length > 0">
    <app-base-card [variant]="'elevated'">
      <div class="stat-card">
        <div class="stat-icon error">
          <span class="material-icons">error</span>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ expiredCount() }}</div>
          <div class="stat-label">{{ 'contractReminders.stats.expired' | translate }}</div>
        </div>
      </div>
    </app-base-card>
    <app-base-card [variant]="'elevated'">
      <div class="stat-card">
        <div class="stat-icon error-light">
          <span class="material-icons">warning</span>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ urgentCount() }}</div>
          <div class="stat-label">{{ 'contractReminders.stats.urgent' | translate }}</div>
        </div>
      </div>
    </app-base-card>
    <app-base-card [variant]="'elevated'">
      <div class="stat-card">
        <div class="stat-icon warning">
          <span class="material-icons">schedule</span>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ warningCount() }}</div>
          <div class="stat-label">{{ 'contractReminders.stats.warning' | translate }}</div>
        </div>
      </div>
    </app-base-card>
    <app-base-card [variant]="'elevated'">
      <div class="stat-card">
        <div class="stat-icon info">
          <span class="material-icons">info</span>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ infoCount() }}</div>
          <div class="stat-label">{{ 'contractReminders.stats.info' | translate }}</div>
        </div>
      </div>
    </app-base-card>
  </div>

  <!-- Table -->
  <app-base-async-state
    [loading$]="loading$"
    [data$]="remindersData$"
    [loadingMessage]="'contractReminders.loading' | translate"
    [emptyTitle]="'contractReminders.emptyTitle' | translate"
    [emptyDescription]="'contractReminders.emptyDescription' | translate"
    [onRetry]="onRetryLoad"
  >
    <app-base-table
      [data]="reminders()"
      [columns]="tableColumns"
      [actions]="tableActions"
      [config]="{ showHeader: true, showFooter: true, showPagination: true, showSearch: false, showActions: true, striped: true, hoverable: true }"
      [pageSize]="10"
      (rowClick)="onRowClick($event)"
    >
      <ng-template #cellTemplate let-row="row" let-column="column">
        <ng-container *ngIf="column.key === 'daysUntilExpiry'">
          <app-base-badge [text]="getStatusText(row)" [variant]="getBadgeVariant(row)" size="small"></app-base-badge>
        </ng-container>
      </ng-template>
    </app-base-table>
  </app-base-async-state>
</app-base-private-page-container>

<app-contract-detail
  [contract]="selectedContract"
  [isOpen]="isDetailModalOpen"
  mode="view"
  (closeEvent)="onCloseDetailModal()"
  (contractUpdated)="onContractUpdated()"
></app-contract-detail>
