<!-- Path: GeneralWebApi/Frontend/general-frontend/src/app/features/audit-logs/search-audit-log/search-audit-log.component.html -->
<app-base-card [title]="'Advanced Search'" [icon]="'search'" [variant]="'elevated'">
  <app-base-form
    [config]="searchFormConfig"
    [formData]="searchFilters()"
    [loading]="loading()"
    submitText="Search"
    cancelText="Reset"
    (formSubmit)="onFormSubmit($event)"
    (formCancel)="onFormReset()"
  ></app-base-form>
</app-base-card>

<app-base-async-state
  [loading$]="loading$"
  [data$]="logsData$"
  loadingMessage="Searching audit logs..."
  emptyTitle="No Results"
  emptyDescription="No audit logs match your search criteria"
  [onRetry]="onRetryLoad"
>
  <app-base-table
    *ngIf="allLogs().length > 0"
    [data]="allLogs()"
    [columns]="tableColumns"
    [actions]="tableActions"
    [config]="{ showHeader: true, showFooter: true, showPagination: true, showSearch: false, showActions: true, striped: true, hoverable: true }"
    [pageSize]="20"
    (rowClick)="onRowClick($event)"
  >
    <ng-template #cellTemplate let-row="row" let-column="column">
      <ng-container *ngIf="column.key === 'action'">
        <app-base-badge [text]="row.action" [variant]="getActionVariant(row.action)" size="small"></app-base-badge>
      </ng-container>
      <ng-container *ngIf="column.key === 'severity'">
        <app-base-badge [text]="row.severity" [variant]="getSeverityVariant(row.severity)" size="small"></app-base-badge>
      </ng-container>
    </ng-template>
  </app-base-table>
</app-base-async-state>

<app-audit-log-detail
  [log]="selectedLog"
  [isOpen]="isDetailModalOpen"
  (closeEvent)="onCloseDetailModal()"
></app-audit-log-detail>

